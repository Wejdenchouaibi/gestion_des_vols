<div class="login-container">
  <div class="login-card">
    <!-- Header avec logo et titre -->
    <div class="login-header">
      <div class="logo-container">
        <img src="assets/logo Tunisair.png" alt="Tunisair Logo" class="logo">
        <div class="logo-text">
          <h1>TUNISAIR</h1>
          <p>Gestion de Vols</p>
        </div>
      </div>
    </div>

    <!-- Bouton unique pour commencer -->
    <div class="user-type-selection" *ngIf="!selectedRole">
      <h2>Bienvenue !</h2>
      <div style="display: flex; justify-content: center;">
        <button class="start-btn-tunisair" (click)="selectRole('client')">
          <span class="icon-wrapper">
            <i class="fas fa-sign-in-alt"></i>
          </span>
          <span class="btn-text">Click pour commencer</span>
        </button>
      </div>
    </div>

    <!-- Formulaire de connexion/inscription -->
    <div class="login-form-container" *ngIf="selectedRole">
      <!-- Toggle entre connexion et inscription -->
      <div class="mode-toggle">
        <button 
          class="mode-btn" 
          [class.active]="isLoginMode"
          (click)="toggleMode()"
        >
          <i class="fas fa-sign-in-alt"></i>
          Connexion
        </button>
        <button 
          class="mode-btn" 
          [class.active]="!isLoginMode"
          (click)="toggleMode()"
        >
          <i class="fas fa-user-plus"></i>
          Inscription
        </button>
      </div>

      <!-- Formulaire de connexion -->
      <form [formGroup]="loginForm" (ngSubmit)="onSubmit()" class="login-form" *ngIf="isLoginMode">
        <div class="form-group">
          <label for="username">
            <i class="fas fa-user"></i>
            Nom d'utilisateur
          </label>
          <input
            type="text"
            id="username"
            formControlName="username"
            class="form-control"
            [class.is-invalid]="getFieldError('username')"
            placeholder="Entrez votre nom d'utilisateur"
          >
          <div class="invalid-feedback" *ngIf="getFieldError('username')">
            {{ getFieldError('username') }}
          </div>
        </div>

        <div class="form-group">
          <label for="password">
            <i class="fas fa-lock"></i>
            Mot de passe
          </label>
          <input
            type="password"
            id="password"
            formControlName="password"
            class="form-control"
            [class.is-invalid]="getFieldError('password')"
            placeholder="Entrez votre mot de passe"
          >
          <div class="invalid-feedback" *ngIf="getFieldError('password')">
            {{ getFieldError('password') }}
          </div>
        </div>

        <div class="error-message" *ngIf="errorMessage">
          <i class="fas fa-exclamation-triangle"></i>
          {{ errorMessage }}
        </div>

        <button
          type="submit"
          class="btn btn-login"
          [class.admin-login]="selectedRole === 'admin'"
          [class.client-login]="selectedRole === 'client'"
          [disabled]="isLoading"
        >
          <span *ngIf="isLoading" class="spinner-border spinner-border-sm me-2"></span>
          <i *ngIf="!isLoading" class="fas fa-sign-in-alt me-2"></i>
          {{ isLoading ? 'Connexion...' : 'Se connecter' }}
        </button>
      </form>

      <!-- Formulaire d'inscription -->
      <form [formGroup]="registerForm" (ngSubmit)="onSubmit()" class="register-form" *ngIf="!isLoginMode">
        <div class="form-row">
          <div class="form-group">
            <label for="firstName">
              <i class="fas fa-user"></i>
              Prénom
            </label>
            <input
              type="text"
              id="firstName"
              formControlName="firstName"
              class="form-control"
              [class.is-invalid]="getRegisterFieldError('firstName')"
              placeholder="Votre prénom"
            >
            <div class="invalid-feedback" *ngIf="getRegisterFieldError('firstName')">
              {{ getRegisterFieldError('firstName') }}
            </div>
          </div>

          <div class="form-group">
            <label for="lastName">
              <i class="fas fa-user"></i>
              Nom
            </label>
            <input
              type="text"
              id="lastName"
              formControlName="lastName"
              class="form-control"
              [class.is-invalid]="getRegisterFieldError('lastName')"
              placeholder="Votre nom"
            >
            <div class="invalid-feedback" *ngIf="getRegisterFieldError('lastName')">
              {{ getRegisterFieldError('lastName') }}
            </div>
          </div>
        </div>

        <div class="form-group">
          <label for="regUsername">
            <i class="fas fa-at"></i>
            Nom d'utilisateur
          </label>
          <input
            type="text"
            id="regUsername"
            formControlName="username"
            class="form-control"
            [class.is-invalid]="getRegisterFieldError('username')"
            placeholder="Choisissez un nom d'utilisateur"
          >
          <div class="invalid-feedback" *ngIf="getRegisterFieldError('username')">
            {{ getRegisterFieldError('username') }}
          </div>
        </div>

        <div class="form-group">
          <label for="email">
            <i class="fas fa-envelope"></i>
            Email
          </label>
          <input
            type="email"
            id="email"
            formControlName="email"
            class="form-control"
            [class.is-invalid]="getRegisterFieldError('email')"
            placeholder="votre.email@example.com"
          >
          <div class="invalid-feedback" *ngIf="getRegisterFieldError('email')">
            {{ getRegisterFieldError('email') }}
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="regPassword">
              <i class="fas fa-lock"></i>
              Mot de passe
            </label>
            <input
              type="password"
              id="regPassword"
              formControlName="password"
              class="form-control"
              [class.is-invalid]="getRegisterFieldError('password')"
              placeholder="Mot de passe"
            >
            <div class="invalid-feedback" *ngIf="getRegisterFieldError('password')">
              {{ getRegisterFieldError('password') }}
            </div>
          </div>

          <div class="form-group">
            <label for="confirmPassword">
              <i class="fas fa-lock"></i>
              Confirmer
            </label>
            <input
              type="password"
              id="confirmPassword"
              formControlName="confirmPassword"
              class="form-control"
              [class.is-invalid]="getRegisterFieldError('confirmPassword')"
              placeholder="Confirmer le mot de passe"
            >
            <div class="invalid-feedback" *ngIf="getRegisterFieldError('confirmPassword')">
              {{ getRegisterFieldError('confirmPassword') }}
            </div>
          </div>
        </div>

        <div class="error-message" *ngIf="errorMessage">
          <i class="fas fa-exclamation-triangle"></i>
          {{ errorMessage }}
        </div>

        <div class="success-message" *ngIf="successMessage">
          <i class="fas fa-check-circle"></i>
          {{ successMessage }}
        </div>

        <button
          type="submit"
          class="btn btn-login"
          [class.admin-login]="selectedRole === 'admin'"
          [class.client-login]="selectedRole === 'client'"
          [disabled]="isLoading"
        >
          <span *ngIf="isLoading" class="spinner-border spinner-border-sm me-2"></span>
          <i *ngIf="!isLoading" class="fas fa-user-plus me-2"></i>
          {{ isLoading ? 'Création...' : 'Créer le compte' }}
        </button>
      </form>

    </div>

    <!-- Bouton pour changer de rôle -->
    <div class="change-role" *ngIf="selectedRole">
      <button class="btn btn-link" (click)="changeRole()">
        <i class="fas fa-arrow-left"></i>
        Changer de type de compte
      </button>
    </div>
  </div>
</div>